---
layout: post
title: Scheme 中的 map 和 apply 函数
date: 2014-06-17
---

###map

它的意思不是地图，而是印射。

它接受两个参数，第一个参数是另外一个函数，而第二个参数是一个列表。它将传入的函数应用到第二个参数的每一个成员上，并返回新生成的列表。

```scheme
;;先定义一个add1函数，返回参数值加1.
(define add1
  (lambda (n)
    (+ n 1)))

(map add1 '(1 2 3))
;;=> '(2 3 4)

;;再定义个平方函数，返回平方值
(define square
  (lambda (n)
    (* n n)))

(map square '(1 2 3))
;=> '(1 4 9)
```

###apply

和 map 类似，它也需要两个参数：一个函数及一个列表。它的意思是应用，顾名思义，它将函数应用到列表上。

从表现形式上，可以简单地理解为，把列表扒开，然后把第一个参数放到列表的最左边，然后求值。

```scheme
(apply + '(1 2 3))
;=> 6
;可以理解成这样：
;(+ 1 2 3)

(apply car '((a b c)))
;=> 'a
;可以这样理解：
;(car '(a b c))
```

假如有这样一个列表，'(1 2 3 4)，我们要求它的平方和，可以组合 apply 和 map 来实现：

    (apply + (map square '(1 2 3 4)))
    => 30

####题外, Scheme 可变参数函数的定义

接受至少一个参数的函数：

```scheme
(define f
  (lambda (x . y)
  ...))

;或者
(define (f x . y)
  ...)
```
其中，x 是必须的，独立的，而 y 表示除了 x 以外的所有参数，它是一个列表（如果只有一个参数 x，那么 y 就是个空列表）

如果象这样调用函数`(f 1 2 3 4)`，那么，x 对应 1, 而 y 的值是 '(2 3 4)。


接受任意数量参数的函数：

```scheme
(define f
  (lambda args
    ...))

;或者
(define (f . args)
  ...)
```

使用 lambda 定义函数的时候，如果省略形参的括号，那就表示形参可以传递任意数量的参数进来。同样用列表存储参数。

而如果不使用 lambda 定义函数 ，那么句点不能省略。`(f . args)` 中 ，f 表示函数名 ，  ` . args`表示任意数量的参数。